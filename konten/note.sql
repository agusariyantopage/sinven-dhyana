SELECT kategori.id_kategori,kategori,COUNT(IF(kondisi = 'Baik', 1, NULL)) as qty_baik,COUNT(IF(kondisi = 'Rusak', 1, NULL)) as qty_rusak,COUNT(IF(kondisi = 'Hilang', 1, NULL)) as qty_hilang,SUM(IF(kondisi = 'Baik', nilai_perolehan, 0)) as nilai_baik,SUM(IF(kondisi = 'Hilang', nilai_perolehan, 0)) as nilai_hilang,SUM(IF(kondisi = 'Rusak', nilai_perolehan, 0)) as nilai_rusak,SUM(barang_detail.nilai_perolehan) as total_perolehan from kategori left join subkategori on kategori.id_kategori=subkategori.id_kategori LEFT JOIN barang on barang.id_subkategori=subkategori.id_subkategori left join barang_detail on barang_detail.id_barang=barang.id_barang GROUP by kategori.id_kategori

SELECT lokasi,(SELECT barang.deskripsi FROM barang WHERE barang.id_barang=bd.id_barang) AS deskripsi_barang,COUNT(id_barang_detail) AS jumlah,SUM(nilai_perolehan) AS nilai FROM barang_detail bd WHERE kondisi='Rusak' GROUP BY lokasi,id_barang